<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <title>shop</title>
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/iconfont.css">
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/main.css">
  </head>
  <body>
    <div class="nav-site">
      <div class="container">
        <ul class="fl">
          <li class="fl"><a href="javascript:;" class="nav-site-login">亲，请登录</a></li>
          <li class="fl"><a href="javascript:;" class="nav-site-signup link">免费注册</a></li>
          <li class="fl"><a href="###" target="_blank" class="nav-site-mobile link">手机逛慕陶</a></li>
        </ul>
        <ul class="fr">
          <li class="menu dropdown fl">
            <a href="###" target="_blank" class="dropdown-toggle link transition">我的慕陶<i class="dropdown-arrow iconfont transition">&#xe798;</i></a>
            <ul class="dropdown-layer dropdown-left">
              <li><a href="###" target="_blank" class="menu-item">已经买到的宝贝</a></li>
              <li><a href="###" target="_blank" class="menu-item">我的足迹</a></li>
            </ul>
          </li>
          <li class="menu dropdown fl">
            <a href="###" target="_blank" class="dropdown-toggle link transition">收藏夹<i class="dropdown-arrow iconfont transition">&#xe798;</i></a>
            <ul class="dropdown-layer dropdown-left">
              <li><a href="###" target="_blank" class="menu-item">收藏的宝贝</a></li>
              <li><a href="###" target="_blank" class="menu-item">收藏夹</a></li>
            </ul>
          </li>
          <li class="fl">
            <a href="###" target="_blank" class="link nav-item-category">商品分类</a>
          </li>
          <li class="menu dropdown fl">
            <a href="###" target="_blank" class="dropdown-toggle link transition">卖家中心<i class="dropdown-arrow iconfont transition">&#xe798;</i></a>
            <ul class="dropdown-layer dropdown-left">
              <li><a href="###" target="_blank" class="menu-item">收藏的宝贝</a></li>
              <li><a href="###" target="_blank" class="menu-item">收藏夹</a></li>
            </ul>
          </li>
          <li class="menu nav-site-service dropdown fl">
            <a href="###" target="_blank" class="dropdown-toggle link transition">联系客服<i class="dropdown-arrow iconfont transition">&#xe798;</i></a>
            <ul class="dropdown-layer dropdown-right" data-load="dropdown.json">
              <!-- <li><a href="###" target="_blank" class="menu-item">买家客服</a></li> -->
              <!-- <li><a href="###" target="_blank" class="menu-item">卖家客服</a></li> -->
            </ul>
          </li>
        </ul>
      </div>
    </div>
    <div class="header">
      <div class="container">
        <!-- 用h1是搜索引擎优化 -->
        <h1 class="fl">
          <a href="#" class="header-logo text-hidden">慕陶网</a>
        </h1>
        <div class="search fl">
          <form class="search-form" action="https://s.taobao.com/search">
            <input type="text" name="q" class="search-inputbox fl" autocomplete="off" placeholder="灵魂美食一元抢">
            <input type="submit" value="搜索" class="search-btn fl">
          </form>
          <ul class="search-layer">
            <li class="search-layer-item text-ellipsis" title="">热门搜索</li>
            <li class="search-layer-item text-ellipsis">nice吗</li>
          </ul>
        </div>
        <div class="cart fr transition">
          <div class="fl">
            <a href="#" class="care-shop transition"><i class="iconfont">&#xe61b;</i>购物车</a>
          </div>
          <div class="fr cart-fr">
            <i class="fr iconfont cart-arrow transition">&#xe798;</i>
            <div class="cart-num fr transition">
              0
            </div>
          </div>
          <div class="cart-layer transition fadeOut" data-load="cart.json">
            <div class="loade">
              <div class="loader-1"></div>
              <div class="loader-2"></div>
              <div class="loader-3"></div>
              <div class="loader-4"></div>
              <div class="loader-5"></div>
            </div>
            <!-- <div class="cart-layer-title">
              最新加入的商品
            </div>
            <ul class="cart-layer-list">
              <li class="cart-layer-item clearfix">
                <a href="#" class="fl cart-img"><img src="./img/layer.png" alt=""></a>
                <div class="fl cart-time-ls">
                  <a href="#" class="link cart-tit text-ellipsis">adidas 阿迪达斯 训练 男子</a>
                  <div class="cart-m">
                    ￥335×1
                  </div>
                </div>
              </li>
            </ul>
            <div class="cart-layer-bottom">
              <div class="fl cart-layer-o">
                共27商品
              </div>
              <div class="fl cart-layer-j">
                ￥0.00
              </div>
              <div class="fr cart-layer-m">
                <a href="#">去购物车</a>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
    <div class="nav-section">
      <div class="container">
        <a href="#" class="link">数码城</a
        ><a href="#" class="link">天黑黑</a
        ><a href="#" class="link">天黑黑团购</a
        ><a href="#" class="link">发现</a
        ><a href="#" class="link">二手特价</a
        ><a href="#" class="link">名品汇</a>
      </div>
    </div>

    <!-- <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.js"></script> -->
    <script>window.jQuery || document.write('<script src="js/jquery.js"><\/script>')</script>
    <!-- <script src="./js/index.js" charset="utf-8"></script> -->
    <script src="./case\显示和隐藏/js/transition.js"></script>
    <script src="./case\显示和隐藏/js/index.js"></script>
    <script src="./js/anim.js"></script>
    <!-- <script src="./js/search.js"></script> -->
    <script src="./js/search-fun.js"></script>
    <script type="text/javascript">
    // (function($) {
    //   'use strict'
    //   function dropdown(elem) {
    //     var $elem = $(elem)
    //     $elem.hover(function() {
    //       var $this = $(this)
    //       $this.addClass($this.data('dropdown')+'-active');
    //     }, function() {
    //       var $this = $(this)
    //       $this.removeClass($this.data('dropdown')+'-active');
    //     })
    //   }
    //   $.fn.extend({
    //     dropdown: function() {
    //       this.each(function() {
    //         dropdown(this)
    //       })
    //       return this
    //     }
    //   })
    // })(jQuery);
    // 搜索框
    var html = '',
        htmlload = $('.search-layer').html();
    $('.search').search({
      autocomplete: true,
    }).on('successEvent', function (e, data, $layer) {
      html = createHeaderLyaer(data, $layer)
      //判断是否输入值为空，空则显示默认下拉框，也就是最近搜索下拉框，可以把这些内容存到cookie，或者塞申里面，就可以得到一个用户搜索过的列表

      // if ($('.search-inputbox').val().trim().length === 0) {
      //
      //   return
      // }

      if (html) {
        $layer.html(html)
        $(this).search('showLayer', $layer)
      } else {
        $layer.html('')
        $(this).search('hideLayer', $layer)
      }
    }).on('click', 'li', function() {
      $('.search').search('setInput', $(this).html())
      // $('.search-form').submit()
      $('.search').search('submit')
    }).on('errEvent', function (e, $layer) {
      $layer.html(htmlload)
      // $(this).search('hideLayer', $layer)
    })



    function createHeaderLyaer(data, $layer) {
      //成功回调
      var html = '',
          dataNum = data.result.length,
          numMax = 9; //自定义显示条目
      if (dataNum === 0) { //没有数据就直接退出
        return ''
      }

      for (var i = 0; i < dataNum; i++) { //循环遍历数据
        if (numMax <= i) { //自定义显示条目
          break
        }
        html += '<li class="search-layer-item text-ellipsis">'+data.result[i][0]+'</li>'
      }
      return html
    }

    //购物车
    $('.cart').dropdown({
      animate: 'fade',
      layer: 'cart-layer',
      active: 'cart'
    })

    // 下拉
    $('.dropdown').dropdown({
      animate: 'fade'
    })
    $('.dropdown-layer').on('show', function(e) {
      var html ='',
          $this = $(this),
          load = $(this).data('load')
      if (!load) return
      if (!$(this).data('loader')) {

        $.getJSON('test/'+load, function(json, textStatus) {
          $.each(json, function (index) {
            console.log('s');
            html += `<li><a href="###" target="_blank" class="menu-item">${json[index].title}</a></li>`
          })
          $this.html(html)
          $this.data('loader', true)
        });
      }
      // console.log(e.type);
    })
    $('.cart-layer').on('show', function (e) {
      var html ='',
          $this = $(this),
          load = $(this).data('load'),
          num = 0,
          length = 0;
      if (!load) return
      if (!$(this).data('loader')) {
        html += `<div class="cart-layer-title">
          最新加入的商品
        </div>
        <ul class="cart-layer-list">`;
        setTimeout(function () {
          $.getJSON('test/'+load, function(json, textStatus) {
            $.each(json, function (index) {
              html += `<li class="cart-layer-item clearfix">
              <a href="${json[index].url}" class="fl cart-img"><img src="${json[index].img}" alt=""></a>
              <div class="fl cart-time-ls">
              <a href="#" class="link cart-tit text-ellipsis">${json[index].title}</a>
              <div class="cart-m">
              ${json[index].price}×${json[index].num}
              </div>
              </div>
              </li>`
              num += json[index].price * json[index].num
              length++
            })
            html += `</ul>
            <div class="cart-layer-bottom">
            <div class="fl cart-layer-o">
            共${length}商品
            </div>
            <div class="fl cart-layer-j">
            ￥${num}
            </div>
            <div class="fr cart-layer-m">
            <a href="#">去购物车</a>
            </div>`
            $this.html(html)
            $this.data('loader', true)
          });
        },500)
      }
    })
    </script>
  </body>
</html>
